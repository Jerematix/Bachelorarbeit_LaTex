\documentclass[a4paper, oneside, 12pt]{article}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{graphicx}
\usepackage{longtable}
\usepackage{caption}
\usepackage{titling}
\usepackage{amssymb}
\usepackage{textcomp}
\usepackage{booktabs}
\usepackage{pdflscape}
\usepackage{apacite}
\usepackage{adjustbox}
\usepackage{hyperref}
\hypersetup{
    colorlinks,
    citecolor=black,
    filecolor=black,
    linkcolor=black,
    urlcolor=blue
}
\renewcommand\maketitlehooka{\null\mbox{}\vfill}
\renewcommand\maketitlehookd{\vfill\null}

% set margins for double-sided printing
\usepackage[left=2.5cm, right=2.5cm, top=2.5cm, bottom=2.5cm, bindingoffset=1.5cm, head=15pt]{geometry}
\usepackage{setspace}
\onehalfspacing
% set headers
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhead{}
\fancyfoot{}
\fancyhead[L,RO]{\textsl{\leftmark}}
\fancyhead[R,LO]{\thesisauthor}
\fancyfoot[C]{\thepage}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0pt}

\usepackage[backend=biblatex, giveninits=true, style=apa, maxcitenames=2, ibidtracker=false]{biblatex}
\addbibresource{main.bib}
\pagenumbering{gobble}

\title{Analyzing the Effects of Public Transit Schedules on Shared Mobility Usage}

\newcommand{\thesisdate}{July 26, 2022}
\newcommand{\thesisauthor}{Jeremy Meidinger}
\newcommand{\studentID}{7364610}
\newcommand{\thesistype}{Bachelor Thesis} % Set either to Bachelor or Master
\newcommand{\supervisor}{Univ.-Prof. Dr. Wolfgang Ketter}
\newcommand{\cosupervisor}{Janik Muires}



\begin{document}

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%TITLE PAGE
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    \makeatletter
    \begin{titlepage}
        \begin{center}
            \vspace*{1cm}

            \Large
            \textbf{\@title}

            \vspace{1.5cm}

            \thesistype{}

            \vspace{1cm}

            \begin{figure}[htbp]
                \centering
                \includegraphics[width=.5\linewidth]{./Figures/UoC_Logo}
            \end{figure}

            \vspace{1cm}

            \large
            \textbf{Author}: \thesisauthor{} (Student ID: \studentID{})\\
            \large
            \textbf{Supervisor}: \supervisor{}\\
            \large
            \textbf{Co-Supervisor}: \cosupervisor{}

            \vspace{1cm}
            \large
            Department of Information Systems for Sustainable Society\\
            Faculty of Management, Economics and Social Sciences\\
            University of Cologne\\

            \vspace{1cm}
            \thesisdate

        \end{center}
    \end{titlepage}
    \makeatother

    \clearpage
    \thispagestyle{empty}
    \section*{Eidesstattliche Versicherung}
    \label{sec:SOOA}

    \vspace{2.5cm}

    Hiermit versichere ich an Eides statt, dass ich die vorliegende Arbeit selbstständig und ohne die Benutzung anderer als der angegebenen Hilfsmittel angefertigt habe. Alle Stellen, die wörtlich oder sinngemäß aus veröffentlichten und nicht veröffentlichten Schriften entnommen wurden, sind als solche kenntlich gemacht. Die Arbeit ist in gleicher oder ähnlicher Form oder auszugsweise im Rahmen einer anderen Prüfung noch nicht vorgelegt worden. Ich versichere, dass die eingereichte elektronische Fassung der eingereichten Druckfassung vollständig entspricht.

    \vspace{1cm}

    \noindent
    Die Strafbarkeit einer falschen eidesstattlichen Versicherung ist mir bekannt, namentlich die Strafandrohung gemäß § 156 StGB bis zu drei Jahren Freiheitsstrafe oder Geldstrafe bei vorsätzlicher Begehung der Tat bzw. gemäß § 161 Abs. 1 StGB bis zu einem Jahr Freiheitsstrafe oder Geldstrafe bei fahrlässiger Begehung.

    \vspace{3cm}
    \noindent
    \textbf{\thesisauthor{}}

    \vspace{0.5cm}
    \noindent
    Köln, den 26.07.2022

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %TOC,TOF,TOT
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    \clearpage
    \pagenumbering{Roman}
    \tableofcontents
    \clearpage
    \listoffigures
    \clearpage
    \listoftables
    \clearpage

    \pagenumbering{arabic}


    \section{Introduction}

    \subsection{Problem Statement}

    Sustainability concerns are getting much more important in today's times as effects like climate change and pollution are advancing and risking of making the earth an uninhabitable space.
    According to the \cite{EEA2021} the transportation sector is one of the biggest contributor to greenhouse gas emissions and thus climate change.
    Pollution in cities is a major factor in making cities uninhabitable (CIT:NEEDED)
    Urban mobility is one of the leading contributing factors to pollution and greenhouse gas emission (CIT:NEEDED)
    To solve these challenges that have to be faced, society has to look, at new, alternative ways for transportation
    Public transit is an important factor in urban mobility.
    It is an efficient way to transport many people in a short amount of time, but because of its shortcomings it is not very well liked.
    One of these shortcomings is that it is not always possible to use public transit, because of its schedule, or delays and cancellations, that delay transportation that would have otherwise happened.
    If one wants to travel from point A to point B, they have to wait for the public transit to arrive.

    Another option is to use a shared mobility system, which is a platform that allows people to rent modes of transport like bikes, cars and scooters for a short amount of time, for a typically relatively low fee.
    These systems will be called free floating vehicles (FFVs) in the following text.
    These means of transport are "publicly" available to all people, if they are willing to pay the ride fares and charges the providers demand.
    This has the advantage that as long as there is a shared mobility system, people can travel freely, without having to worry about the public transit schedule.
    Shared mobility has many modes of transportation, some of them are: bike, car, kick scooter, and scooter.
    Though there has been research linking public transit to shared mobility, there is still a lot of research missing, most of it is focused on the first and last mile of public transit.
    There has been no concurrent research on the effects of public transit schedules on shared mobility usage.
    This research could help public transit providers to improve their schedules, and thus improve efficiency.
    Furthermore, it could help shared mobility providers to learn more about the interconnection of public transit and shared mobility, which could lead to better revenue planning and a better market and customer understanding.

    \subsubsection{Research Objective}

    The research objective is to find out if there is any link between public transit schedules and shared mobility usage, especially if a less frequent public transit schedule leads to a higher usage of shared mobility.
    To evaluate that, I got historical data from the public transit schedules and shared mobility usage.
    The research question could be phrased as "Will a difference in public transit schedules lead to an incerease/decerease in shared mobility usage and do the different modes react differently to differences in public transit and if so how?".
    To reach the to answer the question, the research will be divided it in the following substeps:
    \begin{enumerate}
        \item In addition to the provided data from the chair, search for more data, that helps to answer the question.
        \item Get the data in shape to use for analysis.
        \item Analyze the data and try to find influencing factors in the public transit schedules that lead to higher/lower shared mobility usage.
        \item Set up a model that can be used to predict the usage of shared mobility based on the public transit schedules.
        \item Test the model and see if it can answer the research question.
    \end{enumerate}

    %Wo Hypothesen einführen?
    In addition to this general research question the goal is also to introduce some hypothesis, that will be answered using the available data.


    \section{Theoretical Background}

    % Was muss sich an urban mobility ändern, näher auf Daten eingehen mit Fazit, dass sie grüner werden muss und sharing hilft
    % Auch auf public transit an sich eingehen
    %Auch auf die Änderung durch Shared Mobility plattformen eingehen

    \subsection{Recent Changes to Urban Mobility}

    Urban mobility is changing with new introductions to the mobility landscape, like shared mobility platforms and ride hailing.
    \cite{Babar2017} investigated the effects of public transit on ride hailing services.
    They researched about which factors can increase or decrease the usage of ride hailing services like Uber and Lyft.
    To test that, they looked at 833 US cities, that introduced Uber's services and compared the public transit usage before and after.
    They developed a model influenced by the following factors: "Size of the local population, rates of violent crime, weather, gas prices, transit riders' average trip distance and the overall quality of public transit options." (\cite{Babar2017}, p.1).
    They found out that generally, the usage of buses decreases and the usage of trains increases, but this effect also varies widely with some other factors.
    Factors that generally lower bus usage like violent crimes, labor force, hot and snowy days lowered the effect of the introduction of ride hailing services, while the transit quality, the average trip length and gas prices positively moderated the effect ride hailing has on public transit (\cite{Babar2017}, p.28)
    This research shows, that urban mobility is evolving and well established means of mobility like public transit get influenced by new advancements like ride hailing services.
    One of these ways mentioned by research is car-sharing and public transit usage (\cite{Lah2019}, p.142)
    %Die jetzige Zeit ermöglicht durch die schnellere Entwicklung von IS die Möglichkeiten von vehicle sharing, vergleich zu früheren Papern

    \subsection{The need for information systems in shared mobility}

    %Paper von Boeker mentionenen wenn es darum geht, dass die FFV nutzung hoch geht, Beispiel wäre bestimmt auch Call a Bike

    %Wie wurde public transit usage bisher mit ffv

    \subsection{Connecting public transit usage with shared mobility and shared mobility platofrms}

    Other researchers have also already tried connecting FFVS to public transit systems and have found interesting results.
    In a paper already mentioned earlier by \cite{Boeker2020}, they show with data from the Norwegian city of Oslo, that the usage of bike rentals is mostly related to get to public transport, or shopping.
    This connection of bikes to get to public transp

    \subsection{Hypothesis development}


    \section{Method}

    \subsection{Data Description and Collection}

    The data of the public transit, the shared mobility usage, as well as the cumulated service areas are provided by the chair.
    The ride data is 05.11.2019-29.02.2019 with exceptions from the 06.11.2019 - 17.11.2019 and 15.01.2019 - 16.01.2019 for a total of 103 days.
    It was scraped via the API of different FFV providers, in an interval of every 5 minutes.
    Because it was scraped by reverse engineering their providers API's unfortunately there is also incomplete data for some providers.
    The final providers whose data was used for the model are Circ(Kick Scooters), Tier (Kick Scooters), KVB (Bikes), Fordpass (Bikes) and Car2Go (Cars).
    After the cleaning step about 500000 rides remain which are on average roughly 5000 each day.

    The public transit data is provided in the GTFS(General Transit Feed Specification), GTFS is a standard for transportation data, which is used by thousands of public transportation providers (\url{https://gtfs.org/}).
    Generally it's comprised of a database like structure that links the different entities for example stops, routes and trips together via unique IDs.
    The GTFS data is contained in 2 data sets one ranging from the 20.10.2019 - 14.12.2019 and the other one 14.12.2019 - 12.12.2020.
    The GTFS data comprises about 5000 stops, 500 routes and 100000 trips, although most of these are irrelevant, because there is only trip data for Cologne.

    The service area data, is one GeoJSON file, that is a union of all the service areas for Cologne.
    For reasons of simplicity, the trips are not evaluated against the service area of every single provider, but against this union.

    Furthermore, temperature and precipitation data is collected from the DWD (\url{https://dwd.de}), because it is a relevant factor for the usage of micromobility as shown by other research (\cite{Babar2017}, p.18 and \cite{Demircan2021}, p.9).

    \subsection{Model Development}

    \subsubsection{Measuring FFV demand in Space and Time dimension}

    Similar to the models of \cite{Willing_2017_ts}, the dependent variable will be divided in spatio temporal units.
    Firstly, the data has to be sorted spatially, this is done with the help of a concept developed by Uber called h3 (\cite{h3}).
    h3 divides the world in to hexagons, and mathematically a hexagon can always contain 7 smaller hexagons, and that's called h3 resolution.
    For the project I chose the resolution h3 09, which has an area of roughly 0,1km2 with an edge length of about 0,17km, this was the resolution that made the most sense, because of the very short walking distances between public transit stops and FFVs.
    FFVs are not a time efficient way of transport, if the walking distance gets to far.
    The widely regarded walking distance is up to 500 meters, but I argue, that because Cologne having so dense stations, this walking distance only seldom needs to be that high, so h3 resolution 9 gives the most believable numbers, while minimizing the overlap between stations as you see with the ratio value of 90,97\% of Table \ref{tab:h3}.
    Now it is important to go in to detail as why the dependent variable is not only split up spatially, but also temporally.
    Because we mainly want to explain to compare public transit schedules to FFV rentals, I want to have as clear of a picture as possible as to how these relate.
    To factor out time dependent factors, which I introduce 6 timebuckets, that are 4 hours long each(0-4am, 4-8am, 8-12am, 12-4-pm, 4-8pm and 8-12pm).
    This makes our regression coefficients more dependable, because our public transit variables, then do not have to explain time dependent factors.
    In the following I will also show more of these independent variables, mostly focused on trip comfort and I will mention time dependent factors again.

    \subsubsection{Public Transit Variables}

    For every hex and every timeframe, there are four public transit variables, that says how many trips of every category took place in the timeframe.
    The different modes of transport are light rail, bus and regional trains and the number of routes.
    These variables serve as the indicator on to how much public transit was there at the time and at the place, they will be the crucial variables I will look at in connection to hypothesis approval.

    \subsubsection{Trip Comfort Factors}

    Trip comfort factors are also a significant factor found in other research for example the research by \cite{Babar2017} has shown, that cold, hot, rainy and snowy days moderate the impact on city bus utilization of introducing ride hailing in a given city.
    I added in the mean temperature as a factor, as well as precip and the sum of the amount of the precip in the given timespace.
    Because precip and amount of precip have a high correlation, due to the sum of precip amount only being above zero, if there was precip at all, meaning the precip variable is 1, I will closely monitor them to see if I have to eliminate one of the variables.

    \subsubsection{Time Dependent Factors}

    For time dependent factors the time of the days were already mentioned, meaning the 6 timebuckets I established.
    On top of that, I also established another time dependent variable based around weekdays.
    It is a binary variable called if it is a weekday or not, from other research it has been shown, that which day it is, can have a big impact on FFVS demand. (\cite{Willing_2017_im}, p.79)

    \subsection{Data Preparation}

    To achieve the goals of the developed model, the data has to be prepared accordingly, to achieve this goal, the programming language Python (\url{https://www.python.org/}) is used for the data preparation and analysis.
    Most of the packages are commonly used in research projects, so do not have to be explained, but because GTFS data is difficult to handle, a package called GTFSTK (\url{https://github.com/mrcagney/gtfstk}) is used to handle the data, and make the data easily usable for the analysis.

    Firstly I looked at a data to get a better understanding of it.
    Some first key learnings were:

    \begin{enumerate}
        \item Some of the provided data is really inconsistent, and has missing days
        \item GTFS supports unusual time formats like 27:13:00
        \item On the 06.11.2019 the data collection stopped and only resumed on 18.11.2019, so there were many way to long "skewed" trips, also there was an outage between the 15.01.2019 - 16.01.2019.
    \end{enumerate}

    I fixed these issues by firstly removing Lime, Bird, Driveby and Drivenow from the dataset, which is very unfortunate, because they had a lot of data points which are lost because of this, but it will make it easier to compare the other days that way.
    Lime had around 10000 datapoints per day, but there's only available data till 15.12.19, also their trip volume was 5 to 10 times larger than any other kick scooter provider, depending on the day, which makes the data more questionable, and suggests errors in the data fetching.
    Bird only had datapoints in November so it made sense to remove it as well.
    For Drivenow and Driveby it was a bit more complex because Drivenow had data till the 14.01.19, larger depending on the day which is a lot longer and also had much volume, but still not the whole duration so I removed it.
    Driveby had roughly 200 rides per day in Cologne on average, but in the beginning of 2020 the ride numbers drop significantly, about tenfold, so I removed the data, since this drop probably stems from technical difficulties.

    The reason for removing and cleaning all this data is, because the predicitive value fo the model goes down significantly, because the comparison between the days is too difficult, and especially when a lot of the data comes from one provider like with lime, it really skews the model.

    For the GTFS problem, I always included the hours 24:00:00-28:00:00 from the last day in the first time bucket, so the numbers are accurate.
    The problem stems from the KVB counting their days from 03am to 03am the following day, this then also translates to the GTFS data. (CIT:NEEDED)?
    For the last problem, the fix was used to remove all trips that are longer than 24 hours, so that these trips don't get counted, since because of the scraping, it is not possible to know if this was still the same trip, which it presumably was not.

    After cleaning the above mentioned easy errors, the data had to be improved and needed to be brought in shape for the regression.
    Firstly, all of the stations were removed that are not in the service area, because they are not relevant to the analysis.
    I also changed the way to look at the trips, instead of a trip with a defined start and stop, for the planned analysis, it makes more sense to look at a trip as a start and a stop event. This generates more data, and has the advantage, that trips, that only start or end on a station hex don't have to be removed fully.
    To reduce the overlap between stations and have more accurate data, all start and stop events, that did not occur inside of a station hex, were removed.

    Lastly, the stop stats mentioned above are calculated for every stop and then the mean of those values per h3 is taken, this is to provide for the overlap of the close stations, where it is very difficult to say which station the trip belongs to, so it is averaged by h3.
    The data is then grouped first by h3 and then by time to achieve a geospatial model.


    \section{Results}

    \subsection{Model Evaluation}

    \subsection{Hypothesis Discussion}


    \section{Discussion}

    Although I conducted the research very thoroughly there are some points that remain unclear and need to be advanced.
    Firstly I will going in to the points that are influenced by the data that I used for the research.

    The GTFS data only contains plan data and no live data, which is a problem since delays and cancellations are a common occurence among public transportation (CIT:NEEDED) and it would have been especially interesting to analyze data that factors in delays and cancellations.
    With this data it would be possible to learn if people switch spontaneously from their planned public transportation trip to an unplanned FFV trip and because of no actual data and just the plan data being there it's difficult to tell if the numbers are really accurate.

    The trip data only contains winter months, and other research also shows that these comfort factors like temperature and precipitation can influence the amount of FFV usage, this effect is even stronger for uncovered vehicles. (\cite{Demircan2021}, p. 9)
    It would be thus very interesting to have summer and winter data to compare, and see if in the summer passengers are more willing to use FFV platforms.
    Furthermore, the trip data is only retrieved every 5 minutes from the different providers, which can especially for short trips make a big difference, but because only trips that are longer than 24 hours are removed from the dataset, this is not a big problem.

    Also, the positive connection between public transit and FFV demand is just a correlation, and it is very difficult to really attribute a causality to it.
    Naturally as other research has already shown, the demand for FFV is higher in the city centres and as Cologne only has one very clear city center, the demand tends to be the strongest there.
    For example the stop Neumarkt is next to one of the 10 biggest shopping streets in Germany, and also the traffic center of the communal public transit of cologne.
    This makes it of course difficult to differentiate between the traffic that is intrinsic to this shopping streety and the traffic that's there because Neumarkt is a traffic center.


    \section{Conclusion}

    \pagebreak

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %APPENDICES
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


    \appendix
    \renewcommand*{\thesection}{\Alph{section}}\textbf{}

    % APPENDIX A
    Appendix

    \begin{table}
        \centering
        \begin{adjustbox}{width=1.2\textwidth,center=\textwidth}
            \begin{tabular}{lllrrl}
                \toprule
                \textbf{}        & \textbf{H3 Resolution Area} & \textbf{H3 Edge Length} & \textbf{Hexes with Trips} & \textbf{Number of Hexes with Stops} & \textbf{Percentage to stops} \\
                \midrule
                H3 Resolution 10 & 0,015km^2                   & 0,06km                  & 6516                      & 430                                 & 99,54\%                      \\
                H3 Resolution 9  & 0,1km^2                     & 0,17km                  & 1201                      & 393                                 & 90,97\%                      \\
                H3 Resolution 8  & 0,7km^2                     & 0,46km                  & 216                       & 175                                 & 40,51\%                      \\
                H3 Resolution 7  & 5,2km^2                     & 1.22km                  & 51                        & 45                                  & 10,42\%                      \\
                \bottomrule
            \end{tabular}
        \end{adjustbox}
        \caption{Comparison between different h3 resolutions, total of 432 stops in the service area}
        \label{tab:h3}
    \end{table}

    \clearpage
    \printbibliography[heading=bibintoc]

\end{document}
